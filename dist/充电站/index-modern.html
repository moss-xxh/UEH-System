<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>EV Charging Platform - Next Generation Infrastructure</title>
    <link rel="stylesheet" href="css/modern-styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div id="app">
        <!-- Language Selector -->
        <div class="language-selector" style="position: fixed; top: 20px; right: 20px; z-index: 100;">
            <select id="languageSelect" onchange="changeLanguage(this.value)" class="form-input-minimal" style="width: auto; padding: 8px 12px;">
                <option value="en">English</option>
                <option value="zh">中文</option>
                <option value="es">Español</option>
                <option value="fr">Français</option>
                <option value="de">Deutsch</option>
                <option value="ja">日本語</option>
                <option value="ko">한국어</option>
                <option value="ar">العربية</option>
            </select>
        </div>

        <!-- Minimal Navigation -->
        <nav class="minimal-nav" id="mainNav">
            <div class="nav-content">
                <div class="nav-logo">
                    <svg width="28" height="28" viewBox="0 0 28 28" fill="none">
                        <path d="M14 2L2 12L8 12L8 24L20 24L20 12L26 12L14 2Z" fill="currentColor"/>
                    </svg>
                    <span>充电站管理系统</span>
                </div>
                <ul class="nav-links">
                    <li><a href="#" class="nav-link active" onclick="showPage('admin')" data-i18n="nav.admin">平台管理</a></li>
                    <li><a href="#" class="nav-link" onclick="showPage('company')" data-i18n="nav.company">企业管理</a></li>
                    <li><a href="#" class="nav-link" onclick="showPage('mobile')" data-i18n="nav.mobile">移动端预览</a></li>
                </ul>
            </div>
        </nav>


        <!-- Admin Portal -->
        <div id="admin-page" class="page active">
            <div class="dashboard-minimal">
                <!-- Sidebar -->
                <aside class="sidebar-minimal">
                    <div class="sidebar-logo-minimal">
                        <i class="fas fa-shield-alt" style="margin-right: 8px;"></i>
                        平台管理
                    </div>
                    <ul class="sidebar-menu-minimal">
                        <li class="sidebar-item-minimal">
                            <a href="#" class="sidebar-link-minimal active" onclick="showAdminSection('dashboard')">
                                <i class="fas fa-tachometer-alt sidebar-icon"></i>
                                <span>概览</span>
                            </a>
                        </li>
                        <li class="sidebar-item-minimal">
                            <a href="#" class="sidebar-link-minimal" onclick="showAdminSection('tenants')">
                                <i class="fas fa-building sidebar-icon"></i>
                                <span>租户管理</span>
                            </a>
                        </li>
                        <li class="sidebar-item-minimal">
                            <a href="#" class="sidebar-link-minimal" onclick="showAdminSection('monitoring')">
                                <i class="fas fa-chart-bar sidebar-icon"></i>
                                <span>系统监控</span>
                            </a>
                        </li>
                        <li class="sidebar-item-minimal">
                            <a href="#" class="sidebar-link-minimal" onclick="showAdminSection('audit')">
                                <i class="fas fa-file-alt sidebar-icon"></i>
                                <span>审计日志</span>
                            </a>
                        </li>
                        <li class="sidebar-item-minimal">
                            <a href="#" class="sidebar-link-minimal" onclick="showAdminSection('settings')">
                                <i class="fas fa-cog sidebar-icon"></i>
                                <span>系统设置</span>
                            </a>
                        </li>
                    </ul>
                </aside>

                <!-- Main Content -->
                <main class="main-content-minimal">
                    <!-- Dashboard Section -->
                    <div id="admin-dashboard" class="admin-section active">
                        <div class="content-header-minimal">
                            <h1 class="content-title-minimal">平台概览</h1>
                            <p class="content-subtitle-minimal">实时指标和系统健康状态</p>
                        </div>

                        <div class="stats-grid-minimal">
                            <div class="stat-card-minimal">
                                <div class="stat-value-minimal">1,247</div>
                                <div class="stat-label-minimal">总租户数</div>
                                <div class="stat-change positive">
                                    <i class="fas fa-arrow-up"></i>
                                    <span>12% from last month</span>
                                </div>
                            </div>
                            <div class="stat-card-minimal">
                                <div class="stat-value-minimal">45,892</div>
                                <div class="stat-label-minimal">充电站总数</div>
                                <div class="stat-change positive">
                                    <i class="fas fa-arrow-up"></i>
                                    <span>8% growth</span>
                                </div>
                            </div>
                            <div class="stat-card-minimal">
                                <div class="stat-value-minimal">2.4M</div>
                                <div class="stat-label-minimal">活跃用户</div>
                                <div class="stat-change positive">
                                    <i class="fas fa-arrow-up"></i>
                                    <span>24% increase</span>
                                </div>
                            </div>
                            <div class="stat-card-minimal">
                                <div class="stat-value-minimal">8,421</div>
                                <div class="stat-label-minimal">实时充电会话</div>
                                <div class="stat-change negative">
                                    <i class="fas fa-arrow-down"></i>
                                    <span>3% decrease</span>
                                </div>
                            </div>
                        </div>

                        <div class="card-glass" style="margin-top: 32px;">
                            <h3 style="margin-bottom: 24px;">系统性能</h3>
                            <canvas id="performanceChart" height="100"></canvas>
                        </div>
                    </div>

                    <!-- Tenants Section -->
                    <div id="admin-tenants" class="admin-section">
                        <div class="content-header-minimal">
                            <h1 class="content-title-minimal">租户管理</h1>
                            <button class="btn-minimal btn-primary-minimal" onclick="openAddTenantModal()">
                                <i class="fas fa-plus" style="margin-right: 8px;"></i>
                                <span>添加租户</span>
                            </button>
                        </div>

                        <div class="table-minimal">
                            <table style="width: 100%;">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Company Name</th>
                                        <th>Country</th>
                                        <th>Stations</th>
                                        <th>Users</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="tenantsTableBody">
                                    <!-- Dynamic content -->
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Audit Logs Section -->
                    <div id="admin-audit" class="admin-section">
                        <div class="content-header-minimal">
                            <h1 class="content-title-minimal" data-i18n="admin.auditLogs">Audit Logs</h1>
                            <p class="content-subtitle-minimal">System activity and security events</p>
                        </div>

                        <div class="table-minimal">
                            <table style="width: 100%;">
                                <thead>
                                    <tr>
                                        <th>Timestamp</th>
                                        <th>User</th>
                                        <th>Action</th>
                                        <th>Resource</th>
                                        <th>IP Address</th>
                                        <th>Status</th>
                                    </tr>
                                </thead>
                                <tbody id="auditLogsTableBody">
                                    <!-- Dynamic audit logs -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </main>
            </div>
        </div>

        <!-- Company Portal -->
        <div id="company-page" class="page">
            <div class="dashboard-minimal">
                <!-- Sidebar -->
                <aside class="sidebar-minimal">
                    <div class="sidebar-logo-minimal">
                        <i class="fas fa-building" style="margin-right: 8px;"></i>
                        企业管理
                    </div>
                    <ul class="sidebar-menu-minimal">
                        <li class="sidebar-item-minimal">
                            <a href="#" class="sidebar-link-minimal active" onclick="showCompanySection('overview')">
                                <i class="fas fa-tachometer-alt sidebar-icon"></i>
                                <span>概览</span>
                            </a>
                        </li>
                        <li class="sidebar-item-minimal">
                            <a href="#" class="sidebar-link-minimal" onclick="showCompanySection('stations')">
                                <i class="fas fa-charging-station sidebar-icon"></i>
                                <span>充电站管理</span>
                            </a>
                        </li>
                        <li class="sidebar-item-minimal">
                            <a href="#" class="sidebar-link-minimal" onclick="showCompanySection('users')">
                                <i class="fas fa-users sidebar-icon"></i>
                                <span>用户管理</span>
                            </a>
                        </li>
                        <li class="sidebar-item-minimal">
                            <a href="#" class="sidebar-link-minimal" onclick="showCompanySection('pricing')">
                                <i class="fas fa-dollar-sign sidebar-icon"></i>
                                <span>价格设置</span>
                            </a>
                        </li>
                        <li class="sidebar-item-minimal">
                            <a href="#" class="sidebar-link-minimal" onclick="showCompanySection('maintenance')">
                                <i class="fas fa-tools sidebar-icon"></i>
                                <span>维护记录</span>
                            </a>
                        </li>
                    </ul>
                </aside>

                <!-- Main Content -->
                <main class="main-content-minimal">
                    <!-- Overview Section -->
                    <div id="company-overview" class="company-section active">
                        <div class="content-header-minimal">
                            <h1 class="content-title-minimal" data-i18n="company.networkOverview">Network Overview</h1>
                            <p class="content-subtitle-minimal">Your charging infrastructure at a glance</p>
                        </div>

                        <div class="stats-grid-minimal">
                            <div class="stat-card-minimal">
                                <div class="stat-value-minimal">124</div>
                                <div class="stat-label-minimal">Stations</div>
                            </div>
                            <div class="stat-card-minimal">
                                <div class="stat-value-minimal">892</div>
                                <div class="stat-label-minimal">Chargers</div>
                            </div>
                            <div class="stat-card-minimal">
                                <div class="stat-value-minimal">15,420</div>
                                <div class="stat-label-minimal">Users</div>
                            </div>
                            <div class="stat-card-minimal">
                                <div class="stat-value-minimal">$124,500</div>
                                <div class="stat-label-minimal">Monthly Revenue</div>
                            </div>
                        </div>
                    </div>

                    <!-- Stations Management -->
                    <div id="company-stations" class="company-section">
                        <div class="content-header-minimal">
                            <h1 class="content-title-minimal">Station Management</h1>
                            <div style="display: flex; gap: 12px;">
                                <button class="btn-minimal btn-secondary-minimal" onclick="importStations()">
                                    <i class="fas fa-upload"></i> Import CSV
                                </button>
                                <button class="btn-minimal btn-primary-minimal" onclick="openAddStationModal()">
                                    <i class="fas fa-plus"></i> Add Station
                                </button>
                            </div>
                        </div>

                        <div id="stationsGrid" class="stations-grid">
                            <!-- Dynamic station cards -->
                        </div>
                    </div>

                    <!-- Users Management -->
                    <div id="company-users" class="company-section">
                        <div class="content-header-minimal">
                            <h1 class="content-title-minimal">User Management</h1>
                        </div>

                        <div class="table-minimal">
                            <table style="width: 100%;">
                                <thead>
                                    <tr>
                                        <th>User ID</th>
                                        <th>Name</th>
                                        <th>Email</th>
                                        <th>Type</th>
                                        <th>Sessions</th>
                                        <th>Total kWh</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="usersTableBody">
                                    <!-- Dynamic user list -->
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Pricing Management -->
                    <div id="company-pricing" class="company-section">
                        <div class="content-header-minimal">
                            <h1 class="content-title-minimal">Pricing Configuration</h1>
                        </div>

                        <div class="card-glass">
                            <h3>Time-based Pricing</h3>
                            <div class="pricing-schedule">
                                <div class="time-slot">
                                    <span>Peak Hours (6AM - 10AM, 5PM - 9PM)</span>
                                    <input type="number" value="0.45" step="0.01" class="form-input-minimal" style="width: 100px;">
                                    <span>$/kWh</span>
                                </div>
                                <div class="time-slot">
                                    <span>Off-Peak Hours</span>
                                    <input type="number" value="0.25" step="0.01" class="form-input-minimal" style="width: 100px;">
                                    <span>$/kWh</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Maintenance History -->
                    <div id="company-maintenance" class="company-section">
                        <div class="content-header-minimal">
                            <h1 class="content-title-minimal">Maintenance History</h1>
                        </div>

                        <div class="table-minimal">
                            <table style="width: 100%;">
                                <thead>
                                    <tr>
                                        <th>Date</th>
                                        <th>Station</th>
                                        <th>Charger</th>
                                        <th>Type</th>
                                        <th>Technician</th>
                                        <th>Status</th>
                                        <th>Notes</th>
                                    </tr>
                                </thead>
                                <tbody id="maintenanceTableBody">
                                    <!-- Dynamic maintenance records -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </main>
            </div>
        </div>

        <!-- Mobile App View -->
        <div id="mobile-page" class="page">
            <div class="mobile-frame">
                <div class="mobile-screen">
                    <!-- Status Bar -->
                    <div class="mobile-status-bar">
                        <span>9:41 AM</span>
                        <div style="display: flex; gap: 4px;">
                            <i class="fas fa-signal"></i>
                            <i class="fas fa-wifi"></i>
                            <i class="fas fa-battery-full"></i>
                        </div>
                    </div>

                    <!-- App Header -->
                    <div class="mobile-header-minimal">
                        <h3 class="mobile-title-minimal">查找充电站</h3>
                    </div>

                    <!-- Map View -->
                    <div id="mobile-map" style="height: 400px; background: #f0f0f0; position: relative;">
                        <div id="mapContainer" style="width: 100%; height: 100%;"></div>
                        <!-- Search Bar -->
                        <div style="position: absolute; top: 10px; left: 10px; right: 10px;">
                            <input type="text" placeholder="Search location..." class="form-input-minimal" style="width: 100%; background: white;">
                        </div>
                    </div>

                    <!-- Station List -->
                    <div style="padding: 16px; background: white;">
                        <h4 style="margin-bottom: 12px;">Nearby Stations</h4>
                        <div id="stationsList">
                            <!-- Dynamic station list -->
                        </div>
                    </div>

                    <!-- Bottom Navigation -->
                    <div style="position: absolute; bottom: 0; left: 0; right: 0; background: white; border-top: 1px solid #e0e0e0; padding: 8px 0;">
                        <div style="display: flex; justify-content: space-around;">
                            <button class="btn-ghost-minimal" style="flex-direction: column; padding: 8px;">
                                <i class="fas fa-map"></i>
                                <span style="font-size: 11px; margin-top: 4px;">Map</span>
                            </button>
                            <button class="btn-ghost-minimal" style="flex-direction: column; padding: 8px;">
                                <i class="fas fa-qrcode"></i>
                                <span style="font-size: 11px; margin-top: 4px;">Scan</span>
                            </button>
                            <button class="btn-ghost-minimal" style="flex-direction: column; padding: 8px;">
                                <i class="fas fa-history"></i>
                                <span style="font-size: 11px; margin-top: 4px;">History</span>
                            </button>
                            <button class="btn-ghost-minimal" style="flex-direction: column; padding: 8px;">
                                <i class="fas fa-user"></i>
                                <span style="font-size: 11px; margin-top: 4px;">Profile</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modals -->
        <!-- Add Tenant Modal -->
        <div id="addTenantModal" class="modal-backdrop-minimal">
            <div class="modal-minimal">
                <div class="modal-header-minimal">
                    <h3 class="modal-title-minimal">Add New Tenant</h3>
                </div>
                <div class="modal-body-minimal">
                    <form id="addTenantForm" onsubmit="handleAddTenant(event)">
                        <div class="form-group-minimal">
                            <label class="form-label-minimal">Company Name</label>
                            <input type="text" class="form-input-minimal" id="tenantName" required>
                        </div>
                        <div class="form-group-minimal">
                            <label class="form-label-minimal">Contact Email</label>
                            <input type="email" class="form-input-minimal" id="tenantEmail" required>
                        </div>
                        <div class="form-group-minimal">
                            <label class="form-label-minimal">Country</label>
                            <select class="form-input-minimal" id="tenantCountry" required>
                                <option value="">Select Country</option>
                                <option value="US">United States</option>
                                <option value="UK">United Kingdom</option>
                                <option value="DE">Germany</option>
                                <option value="FR">France</option>
                                <option value="CN">China</option>
                                <option value="JP">Japan</option>
                            </select>
                        </div>
                        <div class="form-group-minimal">
                            <label class="form-label-minimal">Subscription Plan</label>
                            <select class="form-input-minimal" id="tenantPlan" required>
                                <option value="starter">Starter</option>
                                <option value="professional">Professional</option>
                                <option value="enterprise">Enterprise</option>
                            </select>
                        </div>
                    </form>
                </div>
                <div class="modal-footer-minimal">
                    <button class="btn-minimal btn-ghost-minimal" onclick="closeModal('addTenantModal')">Cancel</button>
                    <button class="btn-minimal btn-primary-minimal" onclick="document.getElementById('addTenantForm').submit()">Add Tenant</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="js/security.js"></script>
    <script src="js/state-manager.js"></script>
    <script src="js/api-client.js"></script>
    <script src="js/i18n.js"></script>
    <script src="js/modern-app.js"></script>
    <script src="js/audit-system.js"></script>
    <script src="js/user-management.js"></script>
    <script src="js/pricing-manager.js"></script>
    <script src="js/maintenance-tracker.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Initialize Map -->
    <script>
        // Initialize after page load
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
        });
    </script>
</body>
</html>